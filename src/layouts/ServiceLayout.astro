---
import BaseLayout from "@/layouts/BaseLayout.astro";
import HeadWebsite from "@/components/HeadWebSite.astro";
import Map from "@/components/LeafletMap.astro";
import FaqAccordion from "@/components/ui/FaqAccordion.astro";
import { Image } from "astro:assets";

interface Props {
  title: string;
  subtitle: string;
  description: string;
  heroImage: ImageMetadata;
  heroImageAlt: string;
  color: "emerald" | "purple" | "cyan" | "amber";
  faqs?: { question: string; answer: string }[];
}

const {
  title,
  subtitle = "Como funciona",
  description,
  heroImage,
  heroImageAlt,
  color,
  faqs,
} = Astro.props;

const colorMapVariants = {
  emerald: {
    outline: "outline-emerald-500",
    h1: "text-emerald-950",
    h2: "text-emerald-900",
  },
  purple: {
    outline: "outline-purple-500",
    h1: "text-purple-950",
    h2: "text-purple-900",
  },
  cyan: {
    outline: "outline-cyan-500",
    h1: "text-cyan-950",
    h2: "text-cyan-900",
  },
  amber: {
    outline: "outline-amber-500",
    h1: "text-amber-950",
    h2: "text-amber-900",
  },
} satisfies Record<Props["color"], Record<string, string>>;

const theme = colorMapVariants[color];
const outlineClass = `outline-4 outline-offset-4 ${theme.outline}`;
---

<BaseLayout>
  <HeadWebsite
    slot="head"
    title={`${title} | e‑Renova`}
    description={description}
  />

  <div class="container">
    <section
      class="section-intro grid grid-cols-1 lg:grid-cols-2 gap-12 lg:gap-20 items-center"
    >
      <div class="space-y-6">
        <h1 class={`heading-1 ${theme.h1}`}>{title}</h1>
        <div class="text-lg text-gray-700 leading-relaxed text-left space-y-4">
          <slot name="hero-text" />
        </div>
      </div>
      <div
        class={`relative rounded-3xl overflow-hidden shadow-xl aspect-square group max-w-[520px] mx-auto ${outlineClass}`}
      >
        <div
          class="absolute inset-0 bg-emerald-900/10 group-hover:bg-transparent transition-colors duration-500 z-10"
        >
        </div>
        <Image
          src={heroImage}
          alt={heroImageAlt}
          class="w-full h-full object-cover transform transition-transform duration-700 group-hover:scale-105"
        />
      </div>
    </section>

    <section class="section max-w-4xl mx-auto text-center space-y-8">
      <h2 class={`heading-2 mx-auto ${theme.h2}`}>{subtitle}</h2>
      <div class="text-lg text-gray-700 leading-relaxed text-left space-y-4">
        <slot name="secondary-text" />
      </div>
    </section>

    <section class="bg-emerald-50 rounded-3xl p-8 lg:p-12">
      <div class="grid grid-cols-1 lg:grid-cols-3 gap-12 items-start">
        <div
          class="lg:col-span-2 rounded-2xl overflow-hidden shadow-lg border border-emerald-100"
        >
          <Map />
        </div>
        <div class="space-y-6">
          <h3 class="heading-3 text-emerald-800">
            Encontre os parceiros e‑Renova
          </h3>
          <p class="text-gray-700 leading-relaxed">
            <slot name="map-lead">
              Visualize no mapa os pontos de interesse, parceiros e locais de
              coleta mais próximos de você.
            </slot>
          </p>

          <div class="space-y-4 pt-4 border-t border-emerald-200">
            <div class="flex items-start gap-3">
              <span
                class="mt-1 flex h-3 w-3 shrink-0 rounded-full bg-green-500 outline-2 outline-gray-300"
              ></span>
              <div>
                <strong class="block text-sm font-medium text-green-600"
                  >Linha verde</strong
                >
                <span class="text-sm text-gray-600"
                  >Equipamentos de informática e telefonia.</span
                >
              </div>
            </div>
            <div class="flex items-start gap-3">
              <span
                class="mt-1 flex h-3 w-3 shrink-0 rounded-full bg-white outline-2 outline-gray-300"
              ></span>
              <div>
                <strong class="block text-sm font-medium text-gray-400"
                  >Linha Branca</strong
                >
                <span class="text-sm text-gray-600"
                  >Eletrodomésticos de grande porte.</span
                >
              </div>
            </div>
            <div class="flex items-start gap-3">
              <span
                class="mt-1 flex h-3 w-3 shrink-0 rounded-full bg-blue-500 outline-2 outline-gray-300"
              ></span>
              <div>
                <strong class="block text-sm font-medium text-blue-600"
                  >Linha azul</strong
                >
                <span class="text-sm text-gray-600"
                  >Eletrodomésticos portáteis e eletroportáteis.</span
                >
              </div>
            </div>
            <div class="flex items-start gap-3">
              <span
                class="mt-1 flex h-3 w-3 shrink-0 rounded-full bg-amber-700 outline-2 outline-gray-300"
              ></span>
              <div>
                <strong class="block text-sm font-medium text-amber-700"
                  >Linha marrom</strong
                >
                <span class="text-sm text-gray-600"
                  >Equipamentos de áudio e vídeo.</span
                >
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    {
      faqs && faqs.length > 0 && (
        <section class="section max-w-3xl mx-auto space-y-12">
          <h2 class={`heading-2 text-center ${theme.h2}`}>
            Suas Dúvidas Respondidas
          </h2>
          <FaqAccordion items={faqs} color={color} />
        </section>
      )
    }
  </div>
</BaseLayout>

<style>
  .text-outline {
    -webkit-text-stroke: 2px rgb(255, 2, 2);
  }
</style>
