---
import BaseLayout from "@/layouts/BaseLayout.astro";
import HeadWebsite from "@/components/HeadWebSite.astro";
import ServiceMapSection from "@/components/service/ServiceMapSection.astro";
import FaqAccordion from "@/components/ui/FaqAccordion.astro";
import { Image } from "astro:assets";

interface Props {
  title: string;
  subtitle: string;
  description: string;
  heroImage: ImageMetadata;
  heroImageAlt: string;
  color: "emerald" | "purple" | "cyan" | "amber";
  faqs?: { question: string; answer: string }[];
  showMap?: boolean;
}

const {
  title,
  subtitle = "Como funciona",
  description,
  heroImage,
  heroImageAlt,
  color,
  faqs,
  showMap = false,
} = Astro.props;

const colorMapVariants = {
  emerald: {
    outline: "outline-emerald-500",
    h1: "text-emerald-950",
    h2: "text-emerald-900",
    mapBg: "bg-emerald-100",
    mapTitle: "text-emerald-800",
    mapBorder: "border-emerald-100",
    mapIndicator: "border-emerald-200",
  },
  purple: {
    outline: "outline-purple-500",
    h1: "text-purple-950",
    h2: "text-purple-900",
    mapBg: "bg-purple-100",
    mapTitle: "text-purple-800",
    mapBorder: "border-purple-100",
    mapIndicator: "border-purple-200",
  },
  cyan: {
    outline: "outline-cyan-500",
    h1: "text-cyan-950",
    h2: "text-cyan-900",
    mapBg: "bg-cyan-100",
    mapTitle: "text-cyan-800",
    mapBorder: "border-cyan-100",
    mapIndicator: "border-cyan-200",
  },
  amber: {
    outline: "outline-amber-500",
    h1: "text-amber-950",
    h2: "text-amber-900",
    mapBg: "bg-amber-100",
    mapTitle: "text-amber-800",
    mapBorder: "border-amber-100",
    mapIndicator: "border-amber-200",
  },
} satisfies Record<Props["color"], Record<string, string>>;

const theme = colorMapVariants[color];
const outlineClass = `outline-4 outline-offset-4 ${theme.outline}`;
---

<BaseLayout color={color}>
  <HeadWebsite
    slot="head"
    title={`${title} | e‑Renova`}
    description={description}
  />

  <div class="container">
    <section
      class="section-intro grid grid-cols-1 lg:grid-cols-2 gap-12 lg:gap-20 items-center"
    >
      <div class="space-y-6">
        <h1 class={`heading-1 ${theme.h1}`}>{title}</h1>
        <div class="text-lg text-gray-700 leading-relaxed text-left space-y-4">
          <slot name="hero-text" />
        </div>
      </div>
      <div
        class={`relative rounded-3xl overflow-hidden shadow-xl aspect-square group max-w-[520px] mx-auto ${outlineClass}`}
      >
        <div
          class="absolute inset-0 bg-emerald-900/10 group-hover:bg-transparent transition-colors duration-500 z-10"
        >
        </div>
        <Image
          src={heroImage}
          alt={heroImageAlt}
          class="w-full h-full object-cover transform transition-transform duration-700 group-hover:scale-105"
        />
      </div>
    </section>

    <section class="">
      <slot name="cards" />
    </section>

    <section class="section max-w-4xl mx-auto text-center space-y-8">
      <h2 class={`heading-2 mx-auto ${theme.h2}`}>{subtitle}</h2>
      <div class="text-lg text-gray-700 leading-relaxed text-left space-y-4">
        <slot name="secondary-text" />
      </div>
    </section>

    {
      showMap && (
        <ServiceMapSection theme={theme}>
          {Astro.slots.has("map-lead") && (
            <slot name="map-lead" slot="map-lead" />
          )}
        </ServiceMapSection>
      )
    }

    {
      faqs && faqs.length > 0 && (
        <section class="section max-w-3xl mx-auto space-y-12">
          <h2 class={`heading-2 text-center ${theme.h2}`}>
            Suas Dúvidas Respondidas
          </h2>
          <FaqAccordion items={faqs} color={color} />
        </section>
      )
    }
  </div>
</BaseLayout>
