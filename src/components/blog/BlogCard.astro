---
import { Image } from "astro:assets";
import { getFormattedDate } from "@/utils/date";
import type { CollectionEntry } from "astro:content";
import { categories } from "@/data/category";
import Label from "./BlogLabel.astro";

interface Props {
  post: CollectionEntry<"blog">;
}

const { post } = Astro.props;
const {
  title,
  description,
  pubDate,
  heroImage,
  category: categorySlug,
} = post.data;

const category =
  categories.find((c) => c.slug === categorySlug) || categories[0];

const hoverColors = {
  green: "group-hover:text-emerald-700",
  blue: "group-hover:text-blue-600",
  yellow: "group-hover:text-yellow-700",
  purple: "group-hover:text-purple-600",
};

const activeHoverColor =
  hoverColors[category.color as keyof typeof hoverColors] || hoverColors.green;
---

<a
  href={`/blog/${post.id}/`}
  class="group block overflow-hidden rounded-lg bg-white shadow-md transition-all hover:shadow-xl hover:-translate-y-1"
>
  <div class="relative h-48 overflow-hidden">
    {
      heroImage && (
        <Image
          src={heroImage}
          alt={title}
          class="h-full w-full object-cover transition-transform duration-300 group-hover:scale-105"
        />
      )
    }
  </div>
  <div class="p-6">
    <div class="mb-2 flex items-center justify-between">
      <time class="text-sm text-gray-500" datetime={pubDate.toISOString()}>
        {getFormattedDate(pubDate)}
      </time>
      <Label theme={category.color}>{category.title}</Label>
    </div>
    <h3
      class:list={[
        "mb-3 text-xl font-bold text-gray-900 transition-colors",
        activeHoverColor,
      ]}
    >
      {title}
    </h3>
    <p class="text-gray-600 line-clamp-3">
      {description}
    </p>
  </div>
</a>
